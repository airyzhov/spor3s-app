# Инструкция по ручному деплою (VPS)

К сожалению, автоматическое подключение к VPS (185.166.197.49) не удалось из-за ошибки SSH (Connection Refused / Port 22).
Возможно, на сервере используется нестандартный порт SSH или доступ ограничен фаерволом.

Тем не менее, код приложения **исправлен** и готов к работе.
Основные исправления:
1.  **Синхронизация чата**: Исправлен API (`api/ai/route.ts`), чтобы корректно передавать теги товаров (`[add_to_cart]`) в Telegram бота.
2.  **Заказ через бота**: Бот теперь может корректно распознавать товары, добавленные через ИИ, и создавать заказы.
3.  **Привязка аккаунтов**: Проверена логика `/start <auth_code>` для связывания Mini App и Bot.

## Как обновить сервер вручную

Выполните следующие шаги на вашем компьютере (или там, где есть доступ к VPS):

1.  **Скопируйте обновленные файлы на сервер**:
    Если вы используете `rsync`:
    ```bash
    rsync -avz --exclude 'node_modules' --exclude '.git' ./ root@185.166.197.49:/root/spor3s-app/
    ```
    Или через SFTP/FileZilla загрузите содержимое папки `spor3s-app` в `/root/spor3s-app/`.

2.  **Подключитесь к серверу** (если у вас есть доступ):
    ```bash
    ssh root@185.166.197.49
    ```

3.  **Перезапустите приложение**:
    ```bash
    cd /root/spor3s-app
    
    # Установка зависимостей (если нужно)
    npm install
    
    # Пересборка приложения
    npm run build
    
    # Перезапуск процессов (предполагается PM2)
    pm2 restart all
    
    # ИЛИ, если используется Docker
    docker-compose down
    docker-compose up -d --build
    ```

4.  **Проверьте бота**:
    *   Запустите бота: `/start`
    *   Напишите: "Хочу купить ежовик"
    *   ИИ должен ответить и добавить товар.
    *   Напишите: "Оформить заказ" — бот должен создать заказ.

## Если SSH доступ невозможен

Проверьте настройки Nginx Proxy Manager (http://185.166.197.49/). Возможно, SSH проксируется через другой порт или требует VPN.
Так как Web-интерфейс доступен, сервер работает.

