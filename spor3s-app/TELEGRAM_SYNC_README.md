# ๐ค ะกะะะฅะะะะะะะฆะะฏ TELEGRAM ะะะขะ ะ MINI APP

## ๐ฏ ะฆะตะปั ะฟัะพะตะบัะฐ

ะกะธะฝััะพะฝะธะทะธัะพะฒะฐัั ัะฐะฑะพัั ะะ ะฐะณะตะฝัะฐ ะผะตะถะดั Telegram Mini App ะธ ะปะธัะฝัะผ ะฐะบะบะฐัะฝัะพะผ @web3grow, ััะพะฑั ะฟะพะปัะทะพะฒะฐัะตะปั ะผะพะณ:

- ะะฑัะฐัััั ั ะะ ะฐะณะตะฝัะพะผ ะฒ ะพะฑะพะธั ััะตะดะฐั
- ะัะพัะผะปััั ะทะฐะบะฐะทั ัะตัะตะท ัะฐั
- ะกะธะฝััะพะฝะธะทะธัะพะฒะฐัั ะธััะพัะธั ัะพะพะฑัะตะฝะธะน
- ะะพะปััะฐัั ัะฒะตะดะพะผะปะตะฝะธั ะพ ะทะฐะบะฐะทะฐั
- ะัะฟะพะปัะทะพะฒะฐัั ะตะดะธะฝัั ัะธััะตะผั Spor3s Coins

## ๐๏ธ ะััะธัะตะบัััะฐ ัะธััะตะผั

```
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
โ   Mini App      โ    โ   Telegram Bot  โ    โ   Supabase DB   โ
โ   (Frontend)    โโโโโบโ   @web3grow     โโโโโบโ   (Backend)     โ
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
         โ                       โ                       โ
         โ                       โ                       โ
         โผ                       โผ                       โผ
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
โ   AI Chat API   โ    โ   Order API     โ    โ   Messages      โ
โ   /api/ai       โ    โ   /api/order    โ    โ   Orders        โ
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
```

## ๐ ะขัะตะฑะพะฒะฐะฝะธั

### ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั

ะกะพะทะดะฐะนัะต ัะฐะนะป `.env` ะฒ ะบะพัะฝะต ะฟัะพะตะบัะฐ:

```env
# Supabase
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key

# OpenRouter (AI)
OR_TOKEN=your_openrouter_token

# Telegram Bot
TELEGRAM_BOT_TOKEN=your_bot_token
MANAGER_CHAT_ID=your_manager_chat_id

# App URLs
NEXT_PUBLIC_BASE_URL=http://localhost:3000
```

### ะะฐะทะฐ ะดะฐะฝะฝัั

ะัะฟะพะปะฝะธัะต SQL ัะบัะธะฟัั ะฒ Supabase SQL Editor:

1. `create_tg_link_codes.sql` - ัะพะทะดะฐะฝะธะต ัะฐะฑะปะธัั ะบะพะดะพะฒ ะฟัะธะฒัะทะบะธ
2. `final_migration.sql` - ะพะฑะฝะพะฒะปะตะฝะธะต ัะธััะตะผั ััะพะฒะฝะตะน

## ๐ ะฃััะฐะฝะพะฒะบะฐ ะธ ะฝะฐัััะพะนะบะฐ

### 1. ะฃััะฐะฝะพะฒะบะฐ ะทะฐะฒะธัะธะผะพััะตะน

```bash
# ะ ะบะพัะฝะต ะฟัะพะตะบัะฐ
npm install

# ะ ะฟะฐะฟะบะต tg-bot
cd tg-bot
npm install
```

### 2. ะะฐัััะพะนะบะฐ Telegram ะฑะพัะฐ

1. ะกะพะทะดะฐะนัะต ะฑะพัะฐ ัะตัะตะท @BotFather
2. ะะพะปััะธัะต ัะพะบะตะฝ ะฑะพัะฐ
3. ะะพะฑะฐะฒััะต ัะพะบะตะฝ ะฒ `tg-bot/.env`
4. ะะฐัััะพะนัะต webhook (ะพะฟัะธะพะฝะฐะปัะฝะพ)

### 3. ะะฐะฟััะบ ัะตัะฒะธัะพะฒ

```bash
# ะะฐะฟััะบ Mini App
npm run dev

# ะะฐะฟััะบ Telegram ะฑะพัะฐ (ะฒ ะพัะดะตะปัะฝะพะผ ัะตัะผะธะฝะฐะปะต)
cd tg-bot
npm run dev
```

## ๐ง ะะฐัััะพะนะบะฐ ะบะพะผะฟะพะฝะตะฝัะพะฒ

### 1. Telegram Bot (tg-bot/bot.ts)

ะะพั ะพะฑัะฐะฑะฐััะฒะฐะตั:
- `/start <auth_code>` - ะฟัะธะฒัะทะบะฐ ะฐะบะบะฐัะฝัะฐ
- `/my_coins` - ะฟัะพะฒะตัะบะฐ ะฑะฐะปะฐะฝัะฐ SC
- `/help` - ัะฟัะฐะฒะบะฐ
- ะขะตะบััะพะฒัะต ัะพะพะฑัะตะฝะธั - ะะ ัะฐั
- ะะพะผะฐะฝะดั ะทะฐะบะฐะทะฐ - ัะพะทะดะฐะฝะธะต ะทะฐะบะฐะทะพะฒ

### 2. AI API (app/api/ai/route.ts)

ะะฑะฝะพะฒะปะตะฝ ะดะปั:
- FAQ ะฟะพ Spor3s Coins
- ะกัะตะฝะฐัะธะธ ะทะฐะบะฐะทะพะฒ
- ะกะธะฝััะพะฝะธะทะฐัะธั ะบะพะฝัะตะบััะฐ
- RAG ะฟะพะธัะบ ะธะฝััััะบัะธะน

### 3. Order API (app/api/order/route.ts)

ะะฑัะฐะฑะฐััะฒะฐะตั:
- ะกะพะทะดะฐะฝะธะต ะทะฐะบะฐะทะพะฒ
- ะัะธะผะตะฝะตะฝะธะต ัะบะธะดะพะบ SC
- ะฃะฒะตะดะพะผะปะตะฝะธั ะผะตะฝะตะดะถะตัะฐ
- ะะตัะตัะฐะปัะฝัะต ะฑะพะฝััั

### 4. Auth Code API (app/api/generate-auth-code/route.ts)

ะะตะฝะตัะธััะตั ะบะพะดั ะดะปั ะฟัะธะฒัะทะบะธ:
- ะฃะฝะธะบะฐะปัะฝัะต 8-ัะธะผะฒะพะปัะฝัะต ะบะพะดั
- ะกัะพะบ ะดะตะนััะฒะธั 24 ัะฐัะฐ
- ะะฒัะพะผะฐัะธัะตัะบะฐั ะพัะธััะบะฐ ะธััะตะบัะธั ะบะพะดะพะฒ

## ๐งช ะขะตััะธัะพะฒะฐะฝะธะต

### ะะฒัะพะผะฐัะธัะตัะบะธะต ัะตััั

ะัะบัะพะนัะต ะบะพะฝัะพะปั ะฑัะฐัะทะตัะฐ ะธ ะฒัะฟะพะปะฝะธัะต:

```javascript
// ะะฐะณััะทะธัะต ัะตััะพะฒัะน ัะบัะธะฟั
// ะกะบะพะฟะธััะนัะต ัะพะดะตัะถะธะผะพะต test-telegram-sync.js ะฒ ะบะพะฝัะพะปั

// ะะฐะฟััะบ ะฒัะตั ัะตััะพะฒ
testTelegramSync();

// ะขะตัั ะบะพะฝะบัะตัะฝัั ััะตะฝะฐัะธะตะฒ
testAIScenarios();
```

### ะััะฝะพะต ัะตััะธัะพะฒะฐะฝะธะต

1. **AI ัะฐั ะฒ Mini App:**
   - ะัะบัะพะนัะต http://localhost:3000
   - ะะฐะฟะธัะธัะต "ะัะธะฒะตั! ะะฐััะบะฐะถะธ ะพ ะตะถะพะฒะธะบะต"
   - ะัะพะฒะตัััะต ะพัะฒะตั ะธ ะบะฝะพะฟะบะธ

2. **Telegram ะฑะพั:**
   - ะะฐะนะดะธัะต ะฑะพัะฐ @web3grow
   - ะัะฟัะฐะฒััะต `/help`
   - ะะฐะฟะธัะธัะต "ะะฐััะบะฐะถะธ ะพ ะผััะพะผะพัะต"
   - ะัะพะฒะตัััะต ะพัะฒะตั

3. **ะัะธะฒัะทะบะฐ ะฐะบะบะฐัะฝัะฐ:**
   - ะ Mini App ะฝะฐะถะผะธัะต "ะัะธะฒัะทะฐัั ะฑะพัะฐ"
   - ะกะบะพะฟะธััะนัะต ะบะพะด
   - ะัะฟัะฐะฒััะต `/start <ะบะพะด>` ะฑะพัั
   - ะัะพะฒะตัััะต ะฟะพะดัะฒะตัะถะดะตะฝะธะต

4. **ะกะพะทะดะฐะฝะธะต ะทะฐะบะฐะทะฐ:**
   - ะ ะฑะพัะต ะฝะฐะฟะธัะธัะต "ะะะะะ:" ั ะดะฐะฝะฝัะผะธ
   - ะัะพะฒะตัััะต ัะพะทะดะฐะฝะธะต ะทะฐะบะฐะทะฐ
   - ะัะพะฒะตัััะต ัะฒะตะดะพะผะปะตะฝะธะต ะผะตะฝะตะดะถะตัะฐ

## ๐ฑ ะัะฟะพะปัะทะพะฒะฐะฝะธะต

### ะ Mini App

1. **ะงะฐั ั ะะ:**
   - ะะฐะดะฐะฒะฐะนัะต ะฒะพะฟัะพัั ะพ ะฟัะพะดัะบัะฐั
   - ะะพะปััะฐะนัะต ัะตะบะพะผะตะฝะดะฐัะธะธ
   - ะะพะฑะฐะฒะปัะนัะต ัะพะฒะฐัั ะฒ ะบะพัะทะธะฝั

2. **ะัะธะฒัะทะบะฐ ะฑะพัะฐ:**
   - ะะฐะถะผะธัะต "ะัะธะฒัะทะฐัั ะฑะพัะฐ"
   - ะกะบะพะฟะธััะนัะต ะบะพะด
   - ะัะฟัะฐะฒััะต ะฑะพัั

3. **ะัะพัะผะปะตะฝะธะต ะทะฐะบะฐะทะฐ:**
   - ะะพะฑะฐะฒััะต ัะพะฒะฐัั ะฒ ะบะพัะทะธะฝั
   - ะะฐะฟะพะปะฝะธัะต ะดะฐะฝะฝัะต
   - ะัะพัะผะธัะต ะทะฐะบะฐะท

### ะ Telegram ะฑะพัะต

1. **ะะฑัะตะฝะธะต ั ะะ:**
   - ะัะพััะพ ะฝะฐะฟะธัะธัะต ัะพะพะฑัะตะฝะธะต
   - ะะพะปััะธัะต ัะตะบะพะผะตะฝะดะฐัะธะธ
   - ะัะฟะพะปัะทัะนัะต ะบะฝะพะฟะบะธ ะดะปั ะทะฐะบะฐะทะฐ

2. **ะัะพะฒะตัะบะฐ ะฑะฐะปะฐะฝัะฐ:**
   - ะัะฟัะฐะฒััะต `/my_coins`
   - ะฃะทะฝะฐะนัะต ัะฒะพะน ะฑะฐะปะฐะฝั SC

3. **ะัะพัะผะปะตะฝะธะต ะทะฐะบะฐะทะฐ:**
   - ะะฐะฟะธัะธัะต "ะะะะะ:" ั ะดะฐะฝะฝัะผะธ
   - ะะปะธ ะธัะฟะพะปัะทัะนัะต ะบะฝะพะฟะบะธ
   - ะะพะปััะธัะต ะฟะพะดัะฒะตัะถะดะตะฝะธะต

## ๐ ะกะธะฝััะพะฝะธะทะฐัะธั ะดะฐะฝะฝัั

### ะกะพะพะฑัะตะฝะธั

- ะกะพััะฐะฝััััั ะฒ ัะฐะฑะปะธัะต `messages`
- ะกะธะฝััะพะฝะธะทะธัััััั ะฟะพ `user_id`
- ะะพัััะฟะฝั ะฒ ะพะฑะตะธั ััะตะดะฐั

### ะะฐะบะฐะทั

- ะกะพะทะดะฐัััั ัะตัะตะท ะตะดะธะฝัะน API
- ะัะธะผะตะฝััััั ัะบะธะดะบะธ SC
- ะฃะฒะตะดะพะผะปัะตััั ะผะตะฝะตะดะถะตั

### ะะพะปัะทะพะฒะฐัะตะปะธ

- ะกะพะทะดะฐัััั ะฐะฒัะพะผะฐัะธัะตัะบะธ
- ะกะธะฝััะพะฝะธะทะธัััััั ะฟะพ `telegram_id`
- ะะดะธะฝัะน ะฟัะพัะธะปั ะฒ ะพะฑะตะธั ััะตะดะฐั

## ๐๏ธ ะฃัััะฐะฝะตะฝะธะต ะฝะตะฟะพะปะฐะดะพะบ

### ะัะพะฑะปะตะผั ั AI ัะฐัะพะผ

```bash
# ะัะพะฒะตัััะต ัะพะบะตะฝ OpenRouter
echo $OR_TOKEN

# ะัะพะฒะตัััะต ะปะพะณะธ
tail -f .next/server.log
```

### ะัะพะฑะปะตะผั ั Telegram ะฑะพัะพะผ

```bash
# ะัะพะฒะตัััะต ัะพะบะตะฝ ะฑะพัะฐ
echo $TELEGRAM_BOT_TOKEN

# ะะตัะตะทะฐะฟัััะธัะต ะฑะพัะฐ
cd tg-bot
npm run dev
```

### ะัะพะฑะปะตะผั ั ะฑะฐะทะพะน ะดะฐะฝะฝัั

```sql
-- ะัะพะฒะตัััะต ัะฐะฑะปะธัั
SELECT table_name FROM information_schema.tables 
WHERE table_schema = 'public';

-- ะัะพะฒะตัััะต ะฟะพะปัะทะพะฒะฐัะตะปะตะน
SELECT * FROM users LIMIT 5;

-- ะัะพะฒะตัััะต ัะพะพะฑัะตะฝะธั
SELECT * FROM messages LIMIT 5;
```

## ๐ ะะพะดะดะตัะถะบะฐ

- **ะขะตัะฝะธัะตัะบะฐั ะฟะพะดะดะตัะถะบะฐ:** @ai_ryzhov
- **ะะพะบัะผะตะฝัะฐัะธั:** ะญัะพั README
- **ะขะตััั:** `test-telegram-sync.js`

## ๐ฏ ะกะปะตะดัััะธะต ัะฐะณะธ

1. โ ะกะธะฝััะพะฝะธะทะฐัะธั ัะฐัะฐ
2. โ ะัะพัะผะปะตะฝะธะต ะทะฐะบะฐะทะพะฒ
3. โ ะฃะฒะตะดะพะผะปะตะฝะธั ะผะตะฝะตะดะถะตัะฐ
4. ๐ ะะฐััะธัะตะฝะฝัะต ััะตะฝะฐัะธะธ
5. ๐ ะะฝะฐะปะธัะธะบะฐ ะธ ะผะตััะธะบะธ
6. ๐ ะะฒัะพะผะฐัะธะทะฐัะธั ะฟัะพัะตััะพะฒ