# üéØ –ò–¢–û–ì–û–í–û–ï –†–ï–®–ï–ù–ò–ï: –ë–û–¢ @Spor3s_bot

## üìä –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê

### ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç:
- VPS —Å–µ—Ä–≤–µ—Ä: `ai.spor3s.ru` (185.166.197.49) ‚úÖ
- AI API: `https://ai.spor3s.ru/api/ai` ‚úÖ (200 OK)
- –ë–æ—Ç —Ç–æ–∫–µ–Ω: –ê–∫—Ç–∏–≤–µ–Ω ‚úÖ
- Webhook: –ù–∞—Å—Ç—Ä–æ–µ–Ω ‚úÖ

### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞:
- **Endpoint `/api/telegram-webhook` –Ω–µ –Ω–∞–π–¥–µ–Ω –Ω–∞ VPS (404)**
- –§–∞–π–ª —Å–æ–∑–¥–∞–Ω –ª–æ–∫–∞–ª—å–Ω–æ, –Ω–æ –Ω–µ –∑–∞–¥–µ–ø–ª–æ–µ–Ω
- 12 —Å–æ–æ–±—â–µ–Ω–∏–π –∂–¥—É—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏

---

## üöÄ –î–í–ê –†–ï–®–ï–ù–ò–Ø

### üéØ –†–ï–®–ï–ù–ò–ï 1: –ó–ê–í–ï–†–®–ò–¢–¨ –î–ï–ü–õ–û–ô WEBHOOK (–±—ã—Å—Ç—Ä–æ–µ)

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**

1. **–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª –Ω–∞ VPS:**
```bash
# –í–∞—Ä–∏–∞–Ω—Ç –ê: Git
cd C:\Users\User\Documents\spor3s-app\spor3s-app
git add app/api/telegram-webhook/route.ts
git commit -m "Add webhook endpoint"
git push origin main

# –ù–∞ VPS:
ssh root@ai.spor3s.ru
cd /var/www/spor3s-app
git pull
npm run build
pm2 restart all

# –í–∞—Ä–∏–∞–Ω—Ç –ë: –ü—Ä—è–º–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ
ssh root@ai.spor3s.ru
cd /var/www/spor3s-app/app/api
mkdir -p telegram-webhook
nano telegram-webhook/route.ts
# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å: Ctrl+X, Y, Enter
npm run build
pm2 restart all
```

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**
```bash
curl https://ai.spor3s.ru/api/telegram-webhook
# –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å JSON —Å status: ok
```

3. **–¢–µ—Å—Ç:**
–ù–∞–ø–∏—Å–∞—Ç—å @Spor3s_bot "–ø—Ä–∏–≤–µ—Ç"

---

### üéØ –†–ï–®–ï–ù–ò–ï 2: –£–î–ê–õ–ò–¢–¨ WEBHOOK, –ó–ê–ü–£–°–¢–ò–¢–¨ LONG POLLING

**–ë–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç, –µ—Å–ª–∏ webhook –Ω–µ –Ω—É–∂–µ–Ω:**

```bash
# 1. –£–¥–∞–ª–∏—Ç—å webhook
curl -X POST "https://api.telegram.org/bot6522297183:AAE60O9EJy8c8SfdbLOsRGb6B06eHYBWLyo/deleteWebhook"

# 2. –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ VPS
ssh root@ai.spor3s.ru

# 3. –ù–∞–π—Ç–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd /var/www/spor3s-app || cd /home/spor3s-app

# 4. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
pm2 delete all

# 5. –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–æ–≤
cd tg-bot
pm2 start enhanced-bot.js --name spor3s-bot
cd ..
pm2 start start-spor3z-improved.js --name spor3z-bot

# 6. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
pm2 save
pm2 startup

# 7. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
pm2 logs
```

---

## üìÅ –°–û–ó–î–ê–ù–ù–´–ï –§–ê–ô–õ–´ (–ª–æ–∫–∞–ª—å–Ω–æ):

1. ‚úÖ `app/api/telegram-webhook/route.ts` - Webhook handler
2. ‚úÖ `env.local` - –û–±–Ω–æ–≤–ª–µ–Ω –Ω–∞ `https://ai.spor3s.ru`
3. ‚úÖ `tg-bot/env.local` - –û–±–Ω–æ–≤–ª–µ–Ω –Ω–∞ `https://ai.spor3s.ru`
4. ‚úÖ `VPS_BOT_CHECK.md` - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –ø—Ä–æ–≤–µ—Ä–∫–µ
5. ‚úÖ `VPS_SSH_COMMANDS.sh` - –°–∫—Ä–∏–ø—Ç –¥–ª—è VPS
6. ‚úÖ `VPS_QUICK_FIX.txt` - –ö—Ä–∞—Ç–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
7. ‚úÖ `DEPLOY_TO_VPS.md` - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é

---

## üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø:

**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –†–ï–®–ï–ù–ò–ï 2 (Long Polling)** - –ø—Ä–æ—â–µ –∏ –Ω–∞–¥–µ–∂–Ω–µ–µ:

1. –ù—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ SSH –¥–æ—Å—Ç—É–ø –∫ VPS
2. –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–µ–ø–ª–æ–π Next.js –∏–∑–º–µ–Ω–µ–Ω–∏–π
3. –ü—Ä–æ—Ü–µ—Å—Å –±–æ—Ç–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ–∑–∞–≤–∏—Å–∏–º
4. –õ–µ–≥–∫–æ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å —á–µ—Ä–µ–∑ `pm2 logs`

**–û–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞:**
```bash
ssh root@ai.spor3s.ru "cd /var/www/spor3s-app/tg-bot && pm2 start enhanced-bot.js --name spor3s-bot && pm2 save"
```

---

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:

**–ë–ï–ó SSH –î–û–°–¢–£–ü–ê –ö VPS –ë–û–¢ –ù–ï –ó–ê–†–ê–ë–û–¢–ê–ï–¢!**

–ù—É–∂–Ω—ã –¥–∞–Ω–Ω—ã–µ:
- IP/–î–æ–º–µ–Ω: `ai.spor3s.ru` ‚úÖ
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: `root` / `ubuntu` / –¥—Ä—É–≥–æ–π ‚ùì
- –ü–∞—Ä–æ–ª—å –∏–ª–∏ SSH-–∫–ª—é—á ‚ùì

---

## üì± –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï:

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –Ω–∞–ø–∏—Å–∞—Ç—å –±–æ—Ç—É:
- "–ø—Ä–∏–≤–µ—Ç" - –±–∞–∑–æ–≤—ã–π –æ—Ç–≤–µ—Ç
- "–º—É—Ö–æ–º–æ—Ä" - —Ç–æ–≤–∞—Ä —Å –∫–Ω–æ–ø–∫–æ–π –∫–æ—Ä–∑–∏–Ω—ã
- "–º–æ–π –±–∞–ª–∞–Ω—Å" - –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö

---

**–°–¢–ê–¢–£–°:** –í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≥–æ—Ç–æ–≤—ã, –∂–¥—É—Ç –¥–µ–ø–ª–æ—è –Ω–∞ VPS ‚úÖ
