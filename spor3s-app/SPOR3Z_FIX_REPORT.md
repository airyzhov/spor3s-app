# üîß –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú–´: @Spor3z –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

## üîç –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 404** - –º–∞—Ä—à—Ä—É—Ç `/api/ai` –Ω–µ –Ω–∞–π–¥–µ–Ω –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
2. **–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö API –∞–≥–µ–Ω—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç
3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ fallback –æ—Ç–≤–µ—Ç–æ–≤** - –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ API –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç –æ—Ç–≤–µ—Ç

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ `start-spor3z-improved.js`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –£–≤–µ–ª–∏—á–µ–Ω timeout –¥–æ 60 —Å–µ–∫—É–Ω–¥
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–∞ –æ—Ç–≤–µ—Ç–∞
- –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫
- –î–æ–±–∞–≤–ª–µ–Ω fallback –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö API

**–ö–æ–¥:**
```javascript
const response = await axios.post(`${BASE_API_URL}/api/ai`, requestData, {
  timeout: 60000, // –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 30000
  headers: {
    'Content-Type': 'application/json',
    'ngrok-skip-browser-warning': 'true',
    'User-Agent': 'spor3z-bot/1.0',
    'Connection': 'keep-alive'
  },
  validateStatus: () => true // –ü—Ä–∏–Ω–∏–º–∞–µ–º –ª—é–±—ã–µ —Å—Ç–∞—Ç—É—Å—ã
});

if (response.status !== 200) {
  console.log('‚ùå API –≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É:', response.status);
  throw new Error(`API –≤–µ—Ä–Ω—É–ª —Å—Ç–∞—Ç—É—Å ${response.status}`);
}

// Fallback –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
catch (error) {
  console.log('‚ùå –û—à–∏–±–∫–∞ AI API:', error.message);
  const fallbackResponse = generateIntelligentFallback(message, context);
  return fallbackResponse;
}
```

### 2. –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback –ø—Ä–∏ –ø—É—Å—Ç–æ–º –æ—Ç–≤–µ—Ç–µ
- –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ö–æ–¥:**
```javascript
const aiResponse = response.data?.response || response.data?.reply || response.data?.message;

if (!aiResponse || aiResponse.trim().length === 0) {
  console.log('‚ö†Ô∏è –ü—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç –æ—Ç API, –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback');
  return generateIntelligentFallback(message, context);
}
```

### 3. –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –î–≤–æ–π–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ (reply + sendMessage)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤

## üìã –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã

### 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω

```bash
# –ù–∞ VPS –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
pm2 status
pm2 logs spor3z-agent --lines 50
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ API –¥–æ—Å—Ç—É–ø–µ–Ω
curl -X POST https://ai.spor3s.ru/api/ai \
  -H "Content-Type: application/json" \
  -d '{"message":"—Ç–µ—Å—Ç","source":"spor3z","context":[]}'
```

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –∞–≥–µ–Ω—Ç–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
pm2 logs spor3z-agent --lines 100 | grep -i "error\|fail\|404"
```

### 4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∞–≥–µ–Ω—Ç

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∞–≥–µ–Ω—Ç
pm2 restart spor3z-agent
pm2 logs spor3z-agent --lines 50
```

### 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤ `.env.local` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:
- `TELEGRAM_API_ID`
- `TELEGRAM_API_HASH`
- `TELEGRAM_SESSION_STRING`
- `NEXT_PUBLIC_BASE_URL=https://ai.spor3s.ru`
- `NEXT_PUBLIC_SUPABASE_URL`
- `NEXT_PUBLIC_SUPABASE_ANON_KEY`

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞

–ó–∞–ø—É—Å—Ç–∏—Ç—å: `node check-spor3z-status.js`

### –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ "–ø—Ä–∏–≤–µ—Ç" –≤ @Spor3z
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –∞–≥–µ–Ω—Ç–∞
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –æ—Ç–≤–µ—Ç –ø–æ–ª—É—á–µ–Ω

## ‚úÖ –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

1. **–ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –æ—Ç–≤–µ—Ç–µ API:**
   - –ê–≥–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç –æ—Ç–≤–µ—Ç –æ—Ç API
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –ë–î

2. **–ü—Ä–∏ –æ—à–∏–±–∫–µ API:**
   - –ê–≥–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç fallback –æ—Ç–≤–µ—Ç
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç fallback –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
   - –õ–æ–≥–∏—Ä—É–µ—Ç –æ—à–∏–±–∫—É

3. **–ü—Ä–∏ –ø—É—Å—Ç–æ–º –æ—Ç–≤–µ—Ç–µ:**
   - –ê–≥–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç fallback –æ—Ç–≤–µ—Ç
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç fallback –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –ö–æ–¥ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω
2. ‚è≥ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
3. ‚è≥ –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ API –¥–æ—Å—Ç—É–ø–µ–Ω
4. ‚è≥ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –∞–≥–µ–Ω—Ç–∞
5. ‚è≥ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π

## üîó –§–∞–π–ª—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

- `start-spor3z-improved.js` - –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –∞–≥–µ–Ω—Ç–∞
- `check-spor3z-status.js` - —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞
- `app/api/ai/route.ts` - API endpoint (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω)

